<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>lib/settings.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="http://www.emresakarya.com/mini-memory" target="_blank" class="menu-item" id="demo_link" >Demo Website</a></h2><h2><a href="https://codepen.io/softberry/pen/dwBrNB" target="_blank" class="menu-item" id="codepen_link" >Playground</a></h2><h2><a href="http://github.com/softberry/memory-game" target="_blank" class="menu-item" id="github_link" >GitHub</a></h2><h3>Classes</h3><ul><li><a href="MiniMemory.html">MiniMemory</a><ul class='members'><li data-type='member' style='display: none;'><a href="MiniMemory.html#toolbar">toolbar</a></li><li data-type='member' style='display: none;'><a href="MiniMemory.html#private">private</a></li><li data-type='member' style='display: none;'><a href="MiniMemory.html#settings">settings</a></li><li data-type='member' style='display: none;'><a href="MiniMemory.html#layers">layers</a></li><li data-type='member' style='display: none;'><a href="MiniMemory.html#cardBack">cardBack</a></li><li data-type='member' style='display: none;'><a href="MiniMemory.html#.observedAttributes">observedAttributes</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="MiniMemory.html#reset">reset</a></li><li data-type='method' style='display: none;'><a href="MiniMemory.html#connectedCallback">connectedCallback</a></li><li data-type='method' style='display: none;'><a href="MiniMemory.html#disconnectedCallback">disconnectedCallback</a></li><li data-type='method' style='display: none;'><a href="MiniMemory.html#adoptedCallback">adoptedCallback</a></li><li data-type='method' style='display: none;'><a href="MiniMemory.html#attributeChangedCallback">attributeChangedCallback</a></li><li data-type='method' style='display: none;'><a href="MiniMemory.html#checkDefaultAttributes">checkDefaultAttributes</a></li><li data-type='method' style='display: none;'><a href="MiniMemory.html#prepareMatrix">prepareMatrix</a></li><li data-type='method' style='display: none;'><a href="MiniMemory.html#myAttributes">myAttributes</a></li><li data-type='method' style='display: none;'><a href="MiniMemory.html#render">render</a></li></ul></li><li></li><li><a href="PrivateIndex.html">PrivateIndex</a><ul class='methods'><li data-type='method' style='display: none;'><a href="PrivateIndex.html#picsum">picsum</a></li><li data-type='method' style='display: none;'><a href="PrivateIndex.html#getOddMidIndex">getOddMidIndex</a></li><li data-type='method' style='display: none;'><a href="PrivateIndex.html#getFreeId">getFreeId</a></li><li data-type='method' style='display: none;'><a href="PrivateIndex.html#reset">reset</a></li><li data-type='method' style='display: none;'><a href="PrivateIndex.html#createTile">createTile</a></li><li data-type='method' style='display: none;'><a href="PrivateIndex.html#limitsExceeded">limitsExceeded</a></li><li data-type='method' style='display: none;'><a href="PrivateIndex.html#getNewImage">getNewImage</a></li></ul></li><li><a href="MemoryCanvaslist.html">MemoryCanvaslist</a><ul class='methods'><li data-type='method' style='display: none;'><a href="MemoryCanvaslist.html#addCanvas">addCanvas</a></li><li data-type='method' style='display: none;'><a href="MemoryCanvaslist.html#randomPair">randomPair</a></li></ul></li><li><a href="Counter.html">Counter</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Counter.html#reset">reset</a></li><li data-type='method' style='display: none;'><a href="Counter.html#start">start</a></li><li data-type='method' style='display: none;'><a href="Counter.html#diff">diff</a></li><li data-type='method' style='display: none;'><a href="Counter.html#stop">stop</a></li></ul></li><li><a href="Fallback.html">Fallback</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Fallback.html#init">init</a></li></ul></li><li><a href="FullScreen.html">FullScreen</a><ul class='methods'><li data-type='method' style='display: none;'><a href="FullScreen.html#enter">enter</a></li><li data-type='method' style='display: none;'><a href="FullScreen.html#exit">exit</a></li></ul></li><li><a href="Game.html">Game</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Game.html#addImage">addImage</a></li><li data-type='method' style='display: none;'><a href="Game.html#prepare">prepare</a></li><li data-type='method' style='display: none;'><a href="Game.html#openCard">openCard</a></li><li data-type='method' style='display: none;'><a href="Game.html#closeCard">closeCard</a></li><li data-type='method' style='display: none;'><a href="Game.html#drawImageOnCanvas">drawImageOnCanvas</a></li><li data-type='method' style='display: none;'><a href="Game.html#nextLevel">nextLevel</a></li></ul></li><li><a href="Localization.html">Localization</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Localization.html#message">message</a></li><li data-type='method' style='display: none;'><a href="Localization.html#sample">sample</a></li><li data-type='method' style='display: none;'><a href="Localization.html#update">update</a></li></ul></li><li><a href="MemoryImageList.html">MemoryImageList</a><ul class='methods'><li data-type='method' style='display: none;'><a href="MemoryImageList.html#random">random</a></li></ul></li><li><a href="ImageServer.html">ImageServer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ImageServer.html#getManifest">getManifest</a></li><li data-type='method' style='display: none;'><a href="ImageServer.html#getCardImages">getCardImages</a></li><li data-type='method' style='display: none;'><a href="ImageServer.html#done">done</a></li></ul></li><li><a href="MemoryPairsList.html">MemoryPairsList</a><ul class='methods'><li data-type='method' style='display: none;'><a href="MemoryPairsList.html#checkMark">checkMark</a></li><li data-type='method' style='display: none;'><a href="MemoryPairsList.html#hasPair">hasPair</a></li><li data-type='method' style='display: none;'><a href="MemoryPairsList.html#arePairs">arePairs</a></li><li data-type='method' style='display: none;'><a href="MemoryPairsList.html#getImage">getImage</a></li></ul></li><li><a href="CurrentPlayer.html">CurrentPlayer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="CurrentPlayer.html#addScore">addScore</a></li><li data-type='method' style='display: none;'><a href="CurrentPlayer.html#table">table</a></li></ul></li><li><a href="Scores.html">Scores</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Scores.html#addPlayer">addPlayer</a></li></ul></li><li><a href="Settings.html">Settings</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Settings.html#updateChildren">updateChildren</a></li><li data-type='method' style='display: none;'><a href="Settings.html#reset">reset</a></li><li data-type='method' style='display: none;'><a href="Settings.html#enableApplyButton">enableApplyButton</a></li><li data-type='method' style='display: none;'><a href="Settings.html#show">show</a></li><li data-type='method' style='display: none;'><a href="Settings.html#hide">hide</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#excludedImages">excludedImages</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">lib/settings.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { default as template } from '../templates/settings.html';
import { Scores } from './scores';
import { FullScreen } from './fullscreen';

/**
 * Controller for all user defined settings such as, dimentions, fullscreen etc.
 * @class
 */
export class Settings {
  /**
   *
   * @param {{}} owner  An instance of {@link MiniMemory}
   */
  constructor(owner) {
    this.owner = owner;
    this.html = template;
    this.scores = new Scores();
    this.fullScreen = new FullScreen();
  }
  /**
   * Retrieves Panel content from shadow DOM.
   * @param {shadowRoot} shadow
   */
  updateChildren(shadow) {
    const self = this;
    self.panel = shadow.querySelector('#settings');
    self.closeX = shadow.querySelector('#settings .close-x');

    self.labels = {
      playerName: shadow.querySelector('label[for="playerName"]'),
      matrixcol: shadow.querySelector('label[for="matrixcol"]'),
      matrixrow: shadow.querySelector('label[for="matrixrow"]'),
    };

    self.params = {
      languageSelection: shadow.querySelector('#languageSelection'),
      playerName: shadow.querySelector('#playerName'),
      matrixcol: shadow.querySelector('#matrixcol'),
      matrixrow: shadow.querySelector('#matrixrow'),
      isFullScreen: shadow.querySelector('#isFullScreen'),
    };

    self.vCheckFullScreen = shadow.querySelector('#isFullScreen + .vCheck');

    self.applySettings = shadow.querySelector('#applySettings');
    self.restartGame = shadow.querySelector('#restartGame');

    self.closeX.addEventListener('click', () => self.hide());

    self.params.languageSelection.addEventListener('change', (e) => {
      //  self.owner.i18n = new Localization(e.target.value);
      // self.owner.i18n.update(self.shadowRoot);
      self.owner.setAttribute('lang', e.target.value);
    });

    self.vCheckFullScreen.addEventListener('click', (e) => {
      const chk = self.params.isFullScreen;
      chk.checked = !chk.checked;
      self.enableApplyButton.call(self);
    });

    self.applySettings.addEventListener('click', (e) => {
      if (self.params.playerName.value.replace(/\s/g, '').length === 0) {
        self.params.playerName.classList.add('error');
        return;
      }
      const c = self.params.matrixcol.value;
      const r = self.params.matrixrow.value;
      const col = Math.max(Math.min(c, 10), 2);
      const row = Math.max(Math.min(r, 10), 2);

      const vCheckFullScreen = self.params.isFullScreen.checked;
      self.scores.currentPlayer.name = self.params.playerName.value;

      self.owner.layers.toolbar.player.innerText =
        self.scores.currentPlayer.name;

      self.owner.setAttribute('matrix', `${col}x${row}`);

      if (vCheckFullScreen) {
        self.fullScreen.enter();
        self.owner.setAttribute('view', 'fullscreen');
      } else {
        self.fullScreen.exit();
      }
      self.hide();
    });

    self.restartGame.addEventListener('click', (e) => {
      self.hide();

      self.owner.reset();
      self.owner.render();
    });

    document.addEventListener('fullscreenchange', (e) => {
      if (document.fullscreenElement === null) {
        self.owner.setAttribute('view', '');
      }
    });
    Object.keys(self.params).forEach((key) => {
      const param = self.params[key];

      param.addEventListener('focus', () => {
        self.show();
      });
      const events = [];
      param.type === ('text' || 'number')
        ? events.push('blur', 'keyup')
        : events.push('change');
      events.forEach((ev) => {
        param.addEventListener(ev, self.enableApplyButton.bind(self));
      });
    });
  }
  /**
   * Resets Panel content.
   * @param {*} options Given initial options.
   */
  reset(options) {
    [
      this.params.matrixcol.value,
      this.params.matrixrow.value,
    ] = options.matrix.split('x').filter((m) => m !== 'x');
    const curPlayerName = this.scores.currentPlayer.name;

    if (options.settings === 'no') {
      this.owner.layers.toolbar.menu.className = 'hide';
    } else {
      this.owner.layers.toolbar.menu.className = '';
    }

    if (options.view === 'fullscreen') {
      this.params.isFullScreen.checked = true;
      this.params.isFullScreen.setAttribute('checked', 'checked');
    } else {
      this.params.isFullScreen.checked = false;
      this.params.isFullScreen.removeAttribute('checked');
    }

    this.applySettings.setAttribute('disabled', 'disabled');
    this.params.playerName.value = curPlayerName;
    if (curPlayerName &amp;&amp; curPlayerName.length > 0) {
      this.owner.layers.toolbar.player.innerText = curPlayerName;
    } else {
      this.show();
    }
  }

  /**
   * @summary Makes Apply button usable.
   */
  enableApplyButton() {
    this.applySettings.removeAttribute('disabled');
  }

  /**
   * @summary Shows Settings pabel (Sidepanel).
   */
  show() {
    this.panel.classList.add('show');
  }

  /**
   * @summary Hides Settings pabel (Sidepanel).
   */
  hide() {
    this.panel.classList.remove('show');
  }
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/jquery-3.1.1.min.js"></script>

<script src="scripts/search.js"></script>


<script src="scripts/collapse.js"></script>



</body>
</html>
